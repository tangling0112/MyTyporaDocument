# 试验设计

## 1 区组设计

### 1.1 链式区组设计

#### 1.1.1 应用场景

当我们进行==单因子检验==时，若我们的因子$A$有大量的水平,此时如果采用一般的非平衡区组设计,会需要一个很大的实验次数.此时我们就应该考虑使用==链式区组设计==.

#### 1.1.2 链式区组设计

<img src="C:\Users\Administrator\Desktop\Typora文档\试验设计\image-20220331144246897.png" alt="image-20220331144246897" style="zoom: 25%;" />

#### 1.1.3 基本计算步骤

##### 数据预处理

1. 计算$X_i$的值$X_i=A_i$大括号包括的那几行的实验的结果的和
2. 计算$X_i^{'}$的的值$X_i^{'}=A_i^{'}$大括号包括的那几行的实验结果的和
3. 计算$D_i$的值$D_i=X_i-X_i^{'}$
4. 计算$G$的值$G=X_1+X_2+\cdots+X_b$
5. 计算$G^{'}$的值$G^{'}=X_{1}^{'}+X_2^{'}+\cdots+X_b^{'}$
6. 计算$G^{''}$的值$G^{''}=所有不被大括号包括的行的实验结果的和乘以区组数(即列数)$
7. $T=G+G^{'}+G^{''}$
8. $L_1=\sum_{i=1}^b(b-i)×(D_i-D_{i+1})$
9. $H = \frac{G^{'}-G}{mb}$,$m$为$A_i$中处理的个数(也即单个大括号包括的行数)
10. $\hat b_1=\frac{L_1}{2mb}$,$b_i=\hat b_i+\frac{D_i}{m}+H$
11. 若给定水平下有两个观察值那么$\hat {\mu}=\frac{y_i+y_i^{'}}{2}-\frac{\hat b_s+\hat b_m}{2}$,$s,m分别产生是这两个观察值的区组$
12. 若给定水平下有一个观察值那么$\hat \mu=y_i-b_s$,$s为产生这个观察值的区组$

##### 方差分析

**前提**:
$$
T=\sum_{i=1}^{v}\sum_{j=1}^{b}y_{ij}\\
SST=\sum_{i=1}^v\sum_{j=1}^{b}y_{ij}^2-\frac{T^2}{n}\\
B_j=\sum_{i=1}^{v}y_{ij}\\
k_i=第i个区组中的处理数(也即第i列的行数)
$$

1. ==$SSB=\frac{B_1^2}{k_1}+\frac{B_2^2}{k_2}+\cdots+\frac{B_b^2}{k_b}-\frac{T^2}{n},f_B=b-1$==.$SSB$即区组平方和$f_B即为区组自由度$
2. ==$SSA=SST-SSB-SSE,f_A=v-1$==
3. $d_{ij}=A_i的第j个观察值-A_{i}^{'}的第j个观察值$
4. $S_i=\frac{d_{i1^2}+d_{i2^2}+\cdots+d_{im^2}}{2}+\frac{D_i^2}{2m}$
5. $S=\frac{(G-G^{'})^2}{2bm}$
6. ==$SSE=S_1+S_2+\cdots+S_b+S,f_E=n-v-b+1$==

## 2 正交设计

### 2.1 基本知识

- **正交表特性**
  - 任何一列的不同的数字的重复次数相同
  - 任意两列的同行的两个数字组成数对,任何可能的数对的重复次数相同
- **正交表的表示:$L_a(b^c)$**
  - $a$:行数,实验数
  - $b$:表的主体部分可以出现的不同数字的个数
  - $c$:列数,因子数(==使用时空余少数列是可行的==)
- **正交表类型**
  - 完全正交表:$n=q^k,p=\frac{n-1}{q-1},n为行数,q为水平数,p为列数,k\ge2且k\in\R$
  - 非完全正交表:不满足完全正交表就是非完全正交表

### 2.2 无交互下的正交设计

#### 2.2.1 设计的基本步骤

1. 确定因子个数,水平个数
2. 确定合适的正交表
3. 按照正交表对实验进行安排

#### 2.2.2 简单方法判断因子的影响

1. 综合可比性
2. 极差分析法
3. 水平均值图

#### 2.2.3 方差分析

1. 填写计算表<img src="C:\Users\Administrator\Desktop\Typora文档\试验设计\1648889778592.jpg.jpg" alt="1648889778592.jpg" style="zoom: 20%;" />
2. ==$T_{ij}=第i列的所有数字等于j的行对应的观察值的和$==
3. $T=观察值列的所有元素的和$
4. ==$S_T=\sum_{i=1}^n(y_i-\overline y)^2,f_T=n-1,n为总行数(即实验数)$==
5. ==$\bar{T}_{ij}=第i列的j水平下的观察值的均值$==
6. ==$S_i=\frac{n}{q}\sum_{j=1}^{q}(\bar{T}_{ij}-\bar{y})^2,i=1\cdots p,n为实验次数(即行数),q为水平个数,p为因子数$==
7. $f_i=q-1$
8. $f_e=f_T-\sum_{i=1}^{p}f_i$
9. 方差分析
10. 点估计
    - $\hat \mu=\bar y$
    - $\hat a_i=\bar{T}_{1i}-\bar y$
    - $b_j=\bar{T}_{2j}-\bar y$
    - $c_k=\bar{T}_{3k}-\bar y$
    - $\hat\mu_{ijk}=\hat\mu+\hat a_i+\hat b_j+\hat c_k$
11. 区间估计
    1. $n_e=\frac{实验次数}{1+显著因子的自由度的和}$
    2. $S_e^{'}=S_e+不显著因子的平方和$
    3. $f_e^{'}=f_e+不显著的因子的自由度之和$
    4. $\hat\sigma=\sqrt{\frac{S_e^{'}}{f_e^{'}}}$
    5. $\hat\mu_{ijk}±\frac{t_{\frac{1-\alpha}{2}}(f_e^{'})\hat\sigma}{\sqrt{n_e}}$
12. 贡献率分析
    1. $\rho_i=\frac{S_i-(f_i×MSE)}{S_T}$
    2. $\rho_e=f_T×\frac{MSE}{S_T}$

### 2.3 有交互下的正交设计 